network:
  interface: "eth0"
  promisc_mode: true
  snaplen: 65535
  buffer_size: 10000000
  bpf_filter: "tcp or udp or icmp"

variables:
  HOME_NET: "[192.168.1.0/24,10.0.0.0/8]"
  EXTERNAL_NET: "!$HOME_NET"
  HTTP_PORTS: "[80,8080,8000-8999]"
  HTTPS_PORTS: "443"
  DNS_SERVERS: "[8.8.8.8,1.1.1.1]"

rules:
  paths:
    - "rules/local.rules"
    - "rules/community.rules"
  enabled_groups:
    - "web"
    - "malware"
    - "exploit"

detection:
  worker_threads: 0  # 0 = auto-detect (num_cpus - 2)
  packet_queue_size: 10000
  alert_queue_size: 1000

outputs:
  - type: "json"
    path: "/var/log/ks-sniff/alerts.json"

  - type: "fast"
    path: "/var/log/ks-sniff/fast.log"

  - type: "syslog"
    facility: "local0"
    severity: "info"

logging:
  level: "info"
  format: "json"
  output: "/var/log/ks-sniff/ks-sniff.log"
  decode_logging: false  # Enable packet decode logging (or use --decode-logging CLI flag)

performance:
  stats_interval: 60
  enable_profiling: false
